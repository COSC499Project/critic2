-*-org-*-

List of critic2 examples
------------------------

To run these examples, you will need the data files (structures,
densities, etc.). You can download them from:

http://schooner.chem.dal.ca/downloads/critic2/critic2_examples_data.tar.xz

Uncompress the archive inside the examples/ subdirectory (creates
examples/data/). Or, alternatively, by navigating to examples/ and
running the fetch_data.sh script.

* zhurova_tsirelson_srtio3

** Density source: WIEN2k 
** System: SrTiO3 perovskite crystal
** Reference: Zhurova and Tsirelson, Acta Cryst. B (2002) 58, 567-575.

** Description

This example tries to reproduce and expand the results for the SrTiO3
perovskite in:

  Zhurova and Tsirelson, Acta Cryst. B (2002) 58, 567-575.

In contrast to the article, we use the LAPW densities (at the same
calculation parameters) directly, rather than using the calculated
structure factors and a multipolar model. The WIEN2k density and
struct files are provided in the data/ directory, as well as the
runwien input (.wien).

** table2.cri
Automatic search for the critical points of the electron density, and
calculation of the G(r), V(r), and H(r) energy densities at those
points, using the Kirzhnits approximation. 

** basin_shapes.cri
Three-dimensional representation of the atomic basins. Two plots are
made: just the atomic basins, and the same basins with the kinetic
energy density (gtf) color-mapped on the basin surface. 

** figure2.cri
Automatic search for all critical points of the density. Then,
three-dimensional plot of the topological graph (the density gradient
lines connecting atoms through bcps). Also, a three-dimensional
representation of the Sr basin using gradient paths. 

** figure3.cri
Search for critical points, then plots of electron density contours
combined with gradient lines on two different crystallographic planes:
(001) and (222). 

** figure5a.cri
Define the Thomas-Fermi potential energy density (vtf_kir) as a ghost
field, then calculate its critical points, and make the following
plots: a three-dimensional representation of the topological graph for
this field, and a contour plot with gradient lines on the (001) plane.

** figure5b.cri
Define the Thomas-Fermi kinetic energy density (gtf_kir) as a ghost
field, then calculate its critical points, and make the following
plots: a three-dimensional representation of the topological graph for
this field, and a contour plot with gradient lines on the (001) plane.

** figure6-7.cri
Calculate the deformation potential energy density and the deformation
kinetic energy density on the (110) plane. These quantities are
defined as the difference between the potential (kinetic) energy
density obtained using the self-consistent density and that those
obtained from the promolecular density (the sum of atomic
densities). Relief plots are used to present the data.

** more.cri
Locate all the critical points in the unit cell, then integrate the
atomic basin properties (charge and volume) using qtree.

* auto_simple_promolecular

** Density source: none (internal density tables)
** System: pyrazole crystal at the experimental geometry
** Description 

This example (pyrazole.cri) shows how to use the automatic CP search
routine in a simple system: the pyrazole molecular crystal (72 atoms
in the unit cell) with the promolecular density (the sum of atomic
densities). The default automatic search fails to find all critical
points in this case, so an extended seeding strategy needs to be
used. The critical points are written to a obj file for visualization.

* nciplot_surf_kaolinite

** Density source: Quantum ESPRESSO
** System: kaolinite surface (slab) with an adsorbed benzene molecule
** Reference: Johnson and Otero-de-la-Roza, J. Chem. Theory Comput. (2012) 8, 5124.
** Description

The input files (kaoben_hl.cri and kaoben_hb.cri) generate the
NCIplots for benzene adsorbed on both sides (hydrophilic and
hydrophobic) of a kaolinite surface slab. The plots are the same as in
figure 2 of:

  Johnson and Otero-de-la-Roza, J. Chem. Theory Comput. (2012) 8, 5124.

In both cases, the input should be run in two steps. In the first
step, the structure is read and the unit cell is written to an xyz
file. The user then should extract from this xyz the relevant
fragments (using, for instance, a program like avogadro). Those xyz
files are used in the subsequent nciplot run. For convenience, the xyz
files are provided, along with the self-consistent QE electron
density. 

The files generated by nciplot can be opened with vmd (File -> Load
visualization state...).

* electride_yt

** Density source: Quantum ESPRESSO
** System: the K(cryptand-2.2.2) electride (CSD refcode GAVFIS)
** Reference: Dale, Otero-de-la-Roza, and Johnson, Phys. Chem. Chem. Phys. 16 (2014) 14584.
** Description

The K(cryptand-2.2.2) electride (refcode GAVFIS) from the above
reference. 

** GAVFIS10_yt.cri

The pseudo-electron density and the reconstructed valence electron
density are used to integrated the atomic charges and volumes,
including the non-nuclear maximum in the crystal voids. This is done
using a grid integration method (Yu-Trinkle algorithm), and takes
several minutes. The positions of the non-nuclear maxima found by YT
are written to an obj file, and included into the CP list.

** GAVFIS10_promol.cri

The promolecular density is calculated on a grid with the same number
of points as the selfconsistent density from Quantum ESPRESSO, then
saved to a cube file. This data can be used to generate the plot in
Figure 5 using vmd.

* nciplot_thymine
** Density source: Quantum ESPRESSO
** System: thymine crystal.
** Reference: Otero-de-la-Roza, Johnson, and Contreras-Garcia, Phys. Chem. Chem. Phys., 2012, 14, 12165-12172 
** Description

This example shows how to run an NCI plot in a simple molecular
crystal (thymine) using the electron density calculated with Quantum
ESPRESSO. 

** thymine_simple.cri

Calculate the NCI plots in the unit cell using fast Fourier transforms
of the original density. This is a simple and efficient way of
calculating all the NCIs in a periodic crystal. Subsequent
calculations are much faster as long as the grid doesn't change
(e.g. if you only change cutplot, etc.), because it reads the
checkpoint file for the nciplot (ncichk).

** thymine_xyz.cri

Extract fragments of the thymine crystal to xyz files. The fragments
include a snapshot of the unit cell with molecules completed using
atoms from neighboring cells (thymine_cell.xyz), all molecules in the
unit cell in separate xyz files (thymine_burst_*.xyz) and all
molecular pairs in the cell in separate xyz files
(thymine_pairs_*.xyz). These files can be used to focus on a specific
region in subsequent calls to nciplot.

** thymine_intra.cri

An NCIplot showing the hydrogen bonds within the same layer of
thymines. Corresponds to Figure 8b in the cited reference (with
a smaller nstep). 

** thymine_inter.cri

An NCIplot showing the weak interactions between thymine
layers. Corresponds to Figure 8c in the cited reference (with a
smaller nstep). 

* mols_gaussian
** Density source: Gaussian wfn/wfx
** System: benzene, pyridine, and furan
** Description

Simple calculations and plots using Gaussian wfx/wfn wavefunctions.

** benzene.cri

Load the molecular structure for benzene and the wavefunction
contained in a Gaussian wfx file. Then, calculate the critical points
and write them to an obj file together with the periodic cell and the
molecular cell. Use pointprop to activate the calculation of the
kinetic, potential, and total energy densities at the critical
points. Finally, make a plot of the electron density contours with an
overlay of gradient lines.

** pyridine.cri

Same for pyridine.

** furan.cri

Same for furan.

** pyridine_relief.cri

A relief plot of the electron density in the molecular plane of
pyridine. 

* mols_ep
** Density source: Gaussian wfn/wfx
** System: benzene, pyridine, and furan
** Description

Simple calculations and plots using Gaussian cubes generated by
cubegen. 

** pyridine_plane.cri

Plot the electrostatic potential of pyridine with its gradient paths
(field lines) in the molecular plane of pyridine.

** pyridine_field.cri

Plot the gradient paths of the electrostatic potential (field lines)
of pyridine in three dimensions. 

* npf2_phosphazene
** Density source: WIEN2k and Quantum ESPRESSO.
** System: NPF2 phosphazene crystal.
** Description

Comparison of the densities obtained by WIEN2k (all-electron) and QE
(pseudopotentials) for the NPF2 crystal at the same geometry.

** npf2_cps.cri

Find the critical points of the WIEN2k electron density. Then,
calculate the value of the QE and WIEN2k densities at those points,
and their difference. Reprsent the critical points and the chemical
graph in three-dimensional plots.

** npf2_contours.cri

Write contour plots for the WIEN2k and QE densities and their
Laplacians. The Laplacian of the QE density is affected by aliasing
errors. 

** npf2_lap.cri

From the WIEN2k density, calculate the Laplacian and then find its
critical points.

* nciplot_molecule
** Density source: Gaussian wfx.
** System: phenol dimer (gas-phase)
** Description

Running an NCI plot calculation in a molecule.

** phenol_phenol.cri

Run an nciplot calculatin in phenol dimer, using a small molecular
cell.

* stm_gold_benzene
** Density source: Quantum ESPRESSO.
** System: benzene adsorbed on a gold (111) surface.
** Description

Calculate and plot the STM image for benzene on gold (111).

** stm_gold_benzene.cri

Plot the STM image to a data file and write the gnuplot script. Run
gnuplot on the gnu file to generate the image.

* pi_catio3_example
** Density source: aiPI version 7.
** System: CaTiO3 ideal perovskite.
** Description

Several tasks related to the analysis of an electron density for the
CaTiO3 perovskite crystal coming from a aiPI calculation.

** catio3_basins.cri

Plot the atomic basins with the Laplacian of the electron density
mapped on the basin surfaces.

** catio3_cps.cri

Find all the critical points and write them to an obj file.

** catio3_integrals.cri

Integrate the charge and the volume in the atomic densities using a
bisection algorithm.

** catio3_line.cri

Calculate the logarithm of the electron density along interatomic
lines. 

** catio3_qtree.cri

Calculate the atomic charges and volumes using the qtree algorithm.

* blind_test_ciftricks
** Density source: n/a
** System: structures in the fifth blind test.
** Reference: Bardwell et al., Acta Cryst. (2011). B67, 535. (open access)
** Description

A compilation of the experimental structure and a subset of the
submitted structures for molecule XVI in the fifth blind test is
provided with this example. The input blind_test_writeall.cri reads
this compiled cif file, extracts all the structures, and writes them
to separate cif files. This input should be run before any of the
others. This example also shows the use of powdiff to compare crystal
structures, and how to calculate powder diffraction patterns with
critic2. 

** blind_test_writeall.cri

Read all the blocks in the provided cif file (all.cif) and separate
the structures into unique cif files. You should run this input before
the other two.

** blind_test_compare.cri

Compare all proposed crystal structures. To restrict to the comparison
with experiment, grep 'expt.cif' in the critic2 output. The powdiff
value for kendrick-1 compared to the experimental structure is
significantly smaller than any of the others. The match can be
confirmed by inspecting the powder diffraction patterns using the next
input. 

** blind_test_powder.cri

Plot the powder diffraction patterns for the experimental structure
and the three closest matches (kendrick-*.cif). Only kendrick-1.cif
actually matches the experiment, including reflection labels.

* vasp_covellite
** Density source: VASP.
** System: the covellite mineral (CuS).
** Reference: Morales-García et al., J. Phys Chem. A. (2014) 118, 5823.
** Description

The data in Tables 2 and 3 of the cited reference is reproduced. The
VASP densities have been kindly provded by Ángel Morales-García. This
example shows how to calculate atomic charges and volumes and locate
critical points using VASP densities. Generating the AECCAR0 (core
density) and AECCAR2 (reconstructed valence density) requires using
the LAECHG=T flag in the INCAR file. These grids do not integrate to
the correct number of electrons, but they provide the correct basin
shapes, which is not always the case with the pseudo-density
(CHGCAR). 

** table2.cri

Reproduce some of the results in Table 2. Integrate the volumes and
charges at the equilibrium structure using the Yu-Trinkle algorithm.

** table3.cri

Reproduce the results in Table 3. Calculate the critical points of the
reconstructed all-electron density and write them to a graphics file
for visualization. 

* structures
** Density source: n/a.
** System: zincblende, fluorite, MgO.
** Description

Use the crystallography tools in critic2 to build molecular and
crystal structures.

** library.cri

Load the zincblende (ZnS) structure from the library, then write
spherical particles at the crystal geometry with radii 20, 30, and 40
angstrom. Read the fluorite (CaF2) structure from the library and
write cubic particles with sides 20, 30, and 40 angstrom. Read the MgO
structure from the library and write QE template inputs with different
unit cells. Use NEWCELL to transform the conventional to the primitive
cell, then back to the conventional, then a 2x2x2 cubic supercell.

** identify.cri

Build the crystal structure of CdS (wurtzite phase) from scratch using
critic2's symmetry module and the non-equivalent crystallographic
coordinates for the two atoms. Then, extract a 20-angstrom-radius
spherical particle at the crystal geometry. All atoms in the generated
xyz are identified within the crystal (associated atoms and
crystallographic coordinates are found) using the IDENTIFY keyword.

* hf6_cycle
** Density source: Gaussian wfx and Quantum ESPRESSO.
** System: cyclic HF hexamer (gas-phase).
** Description

A calculation of the cyclic planar HF hexamer with Gaussian, and the
same calculation using QE and a periodic supercell. Integration, basin
plotting, critical points, and more.

** hf6_grid_basins.cri

Plot the atomic basins of H and F using the QE reconstructed valence
density. 

** hf6_grid_integrals.cri

Calculate the atomic charges using the QE densities and the Yu-Trinkle
algorithm. 

** hf6_make_qe_supercell.cri

Read the structutre from the wfx file and write it to a number of
different files including gas-phase (xyz, gjf) and periodic (espresso,
vasp, etc.) formats.

** hf6_wfx_bisection.cri

Calculate the atomic charges from the wfx file using bisection.

** hf6_wfx_cps.cri

Locate the critical points using the wfx file.

** hf6_wfx_plane.cri

Contour plot of the wfx electron density and gradient lines in the
molecular plane.

* grid_integration
** Density source: VASP, abinit, and Quantum ESPRESSO.
** System: urea molecular crystal.
** Description

A guide for best practices regarding the integration of atomic volumes
and charges using grid methods. We discuss how to run this
calculations with the three mentioned codes (VASP, abinit, and QE). In
all cases, the integration should be run with the reconstructed
valence or total density (from a PAW calculation) as the reference
field and the pseudo-density for the integrable field. 

The reason is that the valence density should have the interatomic
surfaces at the correct positions, but it is the pseudo-density who
integrates to the correct number of electrons. The pseudo-density can
not be used to calculate the basins because of the pseudopotential
smoothing (sometimes atomic density peaks are missing
altogether). Reconstructed valence densitites can not be used as the
integrand (in general) because grids can not represent accurately the
density peaks near the cores.

A version in which only the pseudo-density is used, augmented with
critic2's core density tables ("poor man's integration") is also
shown, for cases in which the reconstructed density is not available
(e.g. a non-PAW calculation). Despite not being a completely sound
procedure, the results are very similar to those obtained using the
actual reconstructed density.

** vasp.cri

The calculation in VASP requires three files: the CHGCAR
(pseudo-density), the AECCAR0 (core density), and the AECCAR2
(reconstructed valence density). The sum of AECCAR0 and AECCAR2 is
used as reference, and the CHGCAR as integrable. The CHGCAR is
generated by default in VASP, whereas the AECCAR files require using
the LAECHG=T flag in the INCAR.

** abinit.cri

The abinit calculation requires the pseudo-density (_DEN, generated by
prtden = 1), and the reconstructed valence density (_PAWDEN). The flag
prtden = 2 writes both density files, but PAW datasets have to be
used to get a PAWDEN file.

** qe.cri

In Quantum ESPRESSO, the densities are generated as Gaussian cube
files by the post-process program (pp.x). To generate the
pseudo-density, use plot_num = 0. The reconstructed valence density
can only be generated if using PAW datasets, with plot_num = 17.


